pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
function _init()
	t = 0
	p_ani = { 240, 241, 242, 243 }
	dirx = { -1, 1, 0, 0 }
	diry = { 0, 0, -1, 1 }
	_upd = update_game
	_drw = draw_game
	startgame()
end

function _update60()
	t += 1
	_upd()
end

function _draw()
	_drw()
end

function startgame()
	p_x, p_y = 2, 6
	p_ox, p_oy = 0, 0
	p_t = 0

	p_sox, p_soy = 0, 0
end

-->8
--updates

function update_game()
	for i = 0, 3 do
		if btnp(i) then
			local dx, dy = dirx[i + 1], diry[i + 1]
			p_x += dx
			p_y += dy
			p_sox = -dx * 8
			p_soy = -dy * 8
			p_ox = p_sox
			p_oy = p_soy
			p_t = 0
			_upd = update_pturn
			return
		end
	end
end

function update_pturn()
	p_t = min(p_t + 0.125, 1)

	p_ox = p_sox * (1 - p_t)
	p_oy = p_soy * (1 - p_t)

	if p_t == 1 then
		_upd = update_game
	end
end

function update_gameover()
end

-->8
--draws

function draw_game()
	cls(0)
	map()
	drawspr(getframe(p_ani), p_x * 8 + p_ox, p_y * 8 + p_oy, 10)
end

function draw_gameover()
end

-->8
--tools

function getframe(_ani)
	return _ani[flr(t / 15) % #_ani + 1]
end

function drawspr(_spr, _x, _y, _c)
	palt(0, false)
	pal(6, _c)
	spr(_spr, _x, _y)
	pal()
end

__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002020101010101010e02000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002020101010101010200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002010101010101010200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002010101010101010202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00020f0101010101010101010102000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
